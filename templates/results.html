<!DOCTYPE html>
<html>

	<head>
		<title>Results</title>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Rubik:400,700'>
    <link rel='stylesheet' href="./style.css">
		<script src="./script.js"></script>
	</head>

  <body style="background-color:#EFEFEF;">
		<nav>
      <label class="logo">Results</label>
      <ul>
        <li><a href="./app?page=landing">Home</a></li>
				<li><a href="./app?page=exam_list">Exam List</a></li>
				<li><a href="./app?page=view_results">View Results</a></li>
				<li><a href="./logout">Log Out</a>
      </ul>
    </nav>

<!-- View Exam ---------------------------------------------------------------->
		<div class="review">
			{% for qnum in range(questions|length) %}
				{% set q = questions[qnum] %}
				{% set hasConstraint = q.constrainttype is not none %}
				{% set numTestCases = (q.testcaseoutputs|length) %}
				{% set thingsToGrade = 2*numTestCases+1 %}
				{% set numGrades = numTestCases+1 %}
				{% if hasConstraint %}
					{% set thingsToGrade = thingsToGrade+1 %}
					{% set numGrades = numGrades+1 %}
				{% endif %}
				{% set pointsPerThing = (q.points/(thingsToGrade|float))|round(2) %}
				<table style="width:100%">
					<tr> <!-- headers -->
						<th><h3>Question</h3></th>
						<th><h3>Response</h3></th>
						<th><h3>Expected</h3></th>
						<th><h3>Actual</h3></th>
						<th><h3>Max Points</h3></th>
						<th><h3>Autograder Points</h3></th>
						<th><h3>Override Points</h3></th>
					</tr>
				<tr>
					<td rowspan="{{numGrades}}">
						<b>Title:</b> {{ q.title }}<br>
						<b>Total Points:</b> {{ q.points }}<br>
						<b>Prompt:</b><br> {{ q.description }}
					</td>

					<td rowspan="{{numGrades}}"><pre>{{ answers[qnum] }}</pre></td>

					<td>Function should be named: {{ q.functionname }}</td>

					<td>{{ function_names[qnum] }}</td>

					<td>{{ pointsPerThing }}</td>

					<td>+{{ autograderPoints[qnum][0] }}</td>
					<td>+{{ points[qnum][0] }}</td>

					</tr>

					{% if hasConstraint %}
					<td>Constraint: {{ q.constrainttype }}</td>

					<td>{{ detectedConstraints[qnum] }}</td>

					<td>{{ pointsPerThing }}</td>

					<td>+{{ autograderPoints[qnum][numTestCases+1] }}</td>

					<td>+{{ points[qnum][numTestCases+1] }}</td>

					{% endif %}

					{% for tcnum in range(numTestCases) %}
						<tr>
							<td>{{ q.functionname }}({{ q.testcaseargs[tcnum] }}) -> {{ q.testcaseoutputs[tcnum] }}</td>

							<td>
								{% if code_outputs[qnum][tcnum] is not none %}
									{{ code_outputs[qnum][tcnum] }}
								{% else %}
									Code crashed.
								{% endif %}
							</td>

							<td>{{ pointsPerThing*2 }}</td>

							<td>+{{ autograderPoints[qnum][tcnum+1] }}</td>
							<td>+{{ points[qnum][tcnum+1] }}</td>

						</tr>

					{% endfor %}

					<td colspan="4" style=text-align:right;><b>Total:</b></td>
					<td>{{ q.points }}</td>
					<td>{{ (scorePerQuestion[qnum])|round(2) }}</td>
					<td>{{ (scorePerQuestionOverride[qnum])|round(2) }}</td>

				</table><br>

				<h3>Comments:</h3>
				{{ commentsPerQuestion[qnum] }}<br><br><br><br>
				{% endfor %}

					<table style="width:100%;">

						<tr>
							<th><h3>Final Score:</h3></th>
							<th><h3>Overall Test Comments:</h3></th>
						</tr>

						<tr>
							<td style="vertical-align:top;">
								<b>Total:</b> {{ scoreMax }}<br>
								<b>Autograder:</b> {{ (scoreTotal)|round(2) }} <br>
								<b>Override:</b> {{ (scoreTotalOverride)|round(2) }} <!--exam override total -->
							</td>
							<td><textarea name="comments-on-whole-test" cols=100 rows=5>{{ wholeTestComments }}</textarea></td>
						</tr>

					</table><br>

		<a href="/app?page=view_results"><button type="submit">Back to Exams</button></a><br><br>

		</div> <!-- end review -->

  </body>

</html>
